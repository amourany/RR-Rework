package controller;

import view.AbstractView;
import view.GameMenuView;
import view.HelpView;
import view.InGameView;
import view.OptionsView;

import javax.swing.JFrame;

import model.BoxColor;
import model.Direction;
import model.Model;
import model.Robot;

public class Controller {
	private AbstractView view;
	private Model model;
	private JFrame frame;
	private BoxColor selectedRobot; //Color of the selected robot

	public Controller(JFrame f, Model m){
		frame = f;
		model = m;
		createGameMenuView();
	}

	public Model getModel() {
		return model;
	}

	public void setView(AbstractView v) {
		view = v;
	}

	/*
	 * Game menu methods 
	 */
	
	public void createGameMenuView() {
		view = new GameMenuView(this, frame);
	}

	
	/*
	 * Options methods
	 */
	
	public void createOptionsView() {
		view = new OptionsView(this, frame);
		model.generateBoard();
	}
	
	
	/*
	 * In game methods
	 */
	
	public void createInGameView() {
		selectedRobot = BoxColor.Green;
		view = new InGameView(this, frame);
	}

	/* Method called when the user click on a robot */
	public void setSelectedRobot(BoxColor color) {
		selectedRobot = color;
		System.out.println("Selected robot is : "+ selectedRobot);
	}
	
	/** Method called when the user click on the board
	 * It moves the robot and update the view
	 * @param x, y : coordinates of the box clicked
	 */
	public void moveRobot(int x, int y) {
		
		Robot r = model.getRobotByColor(selectedRobot);
		if((r.x < x) && (r.y == y))
			model.move(selectedRobot, Direction.Right);
		else if((r.x > x) && (r.y == y))
			model.move(selectedRobot, Direction.Left);
		else if((r.x == x) && (r.y < y))
			model.move(selectedRobot, Direction.Down);
		else if((r.x == x) && (r.y > y))
			model.move(selectedRobot, Direction.Up);
			
		((InGameView) view).updateRobotPositions(model.getRobots());
	}
	
	/*
	 * Help methods
	 */
	
	public void createHelpView() {
		view = new HelpView(this, frame);
	}
}
